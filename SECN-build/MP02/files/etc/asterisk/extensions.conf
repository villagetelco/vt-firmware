; /etc/asterisk/extensions.conf - Asterisk dial plan for SECN 2
;--------------------------------------------------------------

[general]
static=yes
writeprotect=no
clearglobalvars=no

[globals]

[default]

[incoming]
; Incoming echo test
exten => s,1,Set(MYALERT=${SIP_HEADER(Alert-Info)})
exten => s,n,NoOp(${MYALERT})
exten => s,n,GotoIf($["${MYALERT}" != "Echo"]?dial)
exten => s,n,Answer()
exten => s,n,Playback(echo-test)
exten => s,n,Echo()
exten => s,n,Hangup()
exten => s,n,Dial(MP/1)  

; Send incoming calls to softphone device at exten 300->399
exten => _3XX,1,Dial(SIP/softph${EXTEN})

; Send incoming calls to MP with FXS
exten => 4000,1,Dial(MP/1) 

; This include file is intended for user customisation. 
; File must exist for Asterisk startup.
#include "custom.incoming.extensions.conf"


[outgoing]
; This include file is generated by the SECN web interface /etc/init.d/config_secn
; You may comment out this line and use custom include file below.
#include "potato.extensions.conf"
; This file is intended for user customisation. File must exist for Asterisk startup.
#include "custom.extensions.conf"

; Local echo test
; ---------------
exten => _3246,1,Answer()
exten => _3246,n,Playback(echo-test)
exten => _3246,n,Echo() 
exten => _3246,n,Hangup()

; Abbreviated Dialling
;---------------------
; This file is generated by the script /bin/generate-extension.sh
; Do not edit, this file will be automatically overwritten when you reboot the device.
#include "lastoctet.extensions.conf"

; Full IP dialling, e.g. 10*130*1*144*
;-------------------------------------
; Dialled calls e.g. dial 10*130*1*144
exten => _X*.,1,Set(OCTETS=${EXTEN})
exten => _X*.,n,Set(IP=${CUT(OCTETS,*,1)}.${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)})
exten => _X*.,n,Dial(SIP/4000@${IP})
exten => _XX*.,1,Set(OCTETS=${EXTEN})
exten => _XX*.,n,Set(IP=${CUT(OCTETS,*,1)}.${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)})
exten => _XX*.,n,Dial(SIP/4000@${IP})
exten => _XXX*.,1,Set(OCTETS=${EXTEN})
exten => _XXX*.,n,Set(IP=${CUT(OCTETS,*,1)}.${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)})
exten => _XXX*.,n,Dial(SIP/4000@${IP})

; Remote echo test e.g. dial 3246*10*130*1*144
exten => _3246*X*.,1,Set(OCTETS=${EXTEN})
exten => _3246*X*.,n,Set(IP=${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)}.${CUT(OCTETS,*,5)})
exten => _3246*X*.,n,SIPAddHeader(Alert-Info: Echo)
exten => _3246*X*.,n,Dial(SIP/s@${IP})
exten => _3246*XX*.,1,Set(OCTETS=${EXTEN})
exten => _3246*XX*.,n,Set(IP=${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)}.${CUT(OCTETS,*,5)})
exten => _3246*XX*.,n,SIPAddHeader(Alert-Info: Echo)
exten => _3246*XX*.,n,Dial(SIP/s@${IP})
exten => _3246*XXX*.,1,Set(OCTETS=${EXTEN})
exten => _3246*XXX*.,n,Set(IP=${CUT(OCTETS,*,2)}.${CUT(OCTETS,*,3)}.${CUT(OCTETS,*,4)}.${CUT(OCTETS,*,5)})
exten => _3246*XXX*.,n,SIPAddHeader(Alert-Info: Echo)
exten => _3246*XXX*.,n,Dial(SIP/s@${IP})



